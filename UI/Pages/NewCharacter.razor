@page "/new/{GameName}"
@using Models.Characters
@using Models.Settings
@using Persistence.Json
@using UI.Components
@using UI.Components.NewCharacter
@inject ILoader Loader

<MudContainer MaxWidth="MaxWidth.Small">
	<MudGrid AlignItems="AlignItems.Center">
		<MudItem xs="12">
			<MudText Align="Align.Center" Typo="Typo.h2">Choose a Playbook.</MudText>
		</MudItem>
		@foreach (var (book, hook) in options)
		{
			<MudItem xs="12">
				<NewCharacterPlaybookOption GameSetting="GameSetting" PlaybookName="@book" Hook="@hook" />
			</MudItem>
		}
	</MudGrid>
</MudContainer>

@code
{
	public string GameName { get; set; } = string.Empty;

	GameSetting? GameSetting { get; set; }

	protected override async Task OnInitializedAsync()
	{
		GameSetting = await Loader.LoadSettings(GameName);

		options = GameSetting.Playbooks.Select(p => (p.Name, p.Hook))
			.ToArray();

		await base.OnInitializedAsync();
	}

	private (string, string)[] options = Array.Empty<(string, string)>();
}
